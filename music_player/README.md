# Vela éŸ³ä¹æ’­æ”¾å™¨ ğŸµ

åŸºäº OpenVela ç³»ç»Ÿçš„ç°ä»£åŒ–åµŒå…¥å¼éŸ³ä¹æ’­æ”¾å™¨ï¼Œé‡‡ç”¨å…ˆè¿›çš„ LVGL å›¾å½¢åº“å¼€å‘ã€‚ä¸“ä¸ºè½¦è½½ç¯å¢ƒè®¾è®¡ï¼Œæä¾›ä¸“ä¸šçº§çš„ç”¨æˆ·ç•Œé¢å’Œå“è¶Šçš„éŸ³é¢‘ä½“éªŒï¼Œæ”¯æŒ MP3/WAV æ ¼å¼ã€Wi-Fi è¿æ¥å’Œæ™ºèƒ½æ’­æ”¾åˆ—è¡¨ç®¡ç†ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [æ„å»ºæŒ‡å—](#æ„å»ºæŒ‡å—)
- [éƒ¨ç½²è¿è¡Œ](#éƒ¨ç½²è¿è¡Œ)
- [è‡ªå®šä¹‰æŒ‡å—](#è‡ªå®šä¹‰æŒ‡å—)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
- [API å‚è€ƒ](#api-å‚è€ƒ)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)

## ğŸµ é¡¹ç›®ç®€ä»‹

Vela é«˜çº§è½¦è½½éŸ³ä¹æ’­æ”¾å™¨æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„åµŒå…¥å¼éŸ³ä¹æ’­æ”¾å™¨ï¼Œä¸“ä¸º OpenVela ç³»ç»Ÿå’Œè½¦è½½ç¯å¢ƒè®¾è®¡ã€‚å®ƒæä¾›äº†ç°ä»£åŒ–çš„è½¦è½½ UI ç•Œé¢ï¼Œæ”¯æŒé«˜è´¨é‡éŸ³é¢‘æ’­æ”¾ã€æ™ºèƒ½æ’­æ”¾åˆ—è¡¨ç®¡ç†ã€å¯åŠ¨é¡µé¢ã€éŸ³é‡æ§åˆ¶ç­‰åŠŸèƒ½ã€‚åº”ç”¨ç¨‹åºé‡‡ç”¨å…ˆè¿›çš„æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤ã€‚

### ä¸»è¦äº®ç‚¹

- ğŸš— **è½¦è½½ä¸“ç”¨è®¾è®¡**ï¼šä¸“ä¸ºè½¦è½½ç¯å¢ƒä¼˜åŒ–çš„ç°ä»£åŒ–ç•Œé¢
- ğŸ¨ **é«˜çº§ UI ç³»ç»Ÿ**ï¼šåŸºäº LVGL çš„ç²¾ç¾å›¾å½¢ç•Œé¢ï¼ŒåŒ…å«å¯åŠ¨é¡µé¢ã€ä¸»ç•Œé¢ã€æ’­æ”¾åˆ—è¡¨
- ğŸµ **å¤šæ ¼å¼éŸ³é¢‘**ï¼šæ”¯æŒ MP3 å’Œ WAV æ ¼å¼éŸ³é¢‘æ–‡ä»¶æ’­æ”¾
- ğŸ“± **è§¦å±å‹å¥½**ï¼šå®Œæ•´çš„è§¦å±æ“ä½œæ”¯æŒï¼Œé€‚é…é•¿æ–¹å½¢æ¨¡æ‹Ÿå™¨
- ğŸŒ **ç½‘ç»œåŠŸèƒ½**ï¼šå†…ç½® Wi-Fi è¿æ¥ç®¡ç†
- âš¡ **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–çš„åµŒå…¥å¼ç³»ç»Ÿæ€§èƒ½ï¼Œæ¨¡å—åŒ–éŸ³é¢‘å¤„ç†
- ğŸ”§ **æ¨¡å—åŒ–æ¶æ„**ï¼šå¯åŠ¨é¡µé¢ã€æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ç‹¬ç«‹æ¨¡å—è®¾è®¡
- ğŸ›ï¸ **ä¸“ä¸šæ’­æ”¾åˆ—è¡¨**ï¼šé«˜çº§æ’­æ”¾åˆ—è¡¨ç®¡ç†ï¼Œæ”¯æŒæœç´¢ã€æ’åºã€åŠ¨ç”»

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- â–¶ï¸ éŸ³é¢‘æ’­æ”¾æ§åˆ¶ï¼ˆæ’­æ”¾/æš‚åœ/åœæ­¢ï¼‰
- â­ï¸ ä¸Šä¸€é¦–/ä¸‹ä¸€é¦–åˆ‡æ¢
- ğŸ”Š æ™ºèƒ½éŸ³é‡è°ƒèŠ‚æ§åˆ¶
- ğŸ“‹ é«˜çº§æ’­æ”¾åˆ—è¡¨ç®¡ç†ï¼ˆç‹¬ç«‹æ¨¡å—ï¼‰
- ğŸ•’ å®æ—¶æ’­æ”¾è¿›åº¦æ˜¾ç¤º
- ğŸ“Š é¡¶éƒ¨çŠ¶æ€æ ï¼ˆæ—¶é—´ã€æ—¥æœŸã€Wi-Fiã€ç”µæ± ï¼‰
- ğŸµ å¤šæ ¼å¼éŸ³é¢‘æ”¯æŒï¼ˆMP3/WAVï¼‰

### ç•Œé¢åŠŸèƒ½
- ğŸš— **è½¦è½½ä¸“ç”¨ç•Œé¢**ï¼šç°ä»£åŒ–è½¦è½½é£æ ¼è®¾è®¡
- ğŸŒŸ **å¯åŠ¨é¡µé¢**ï¼šå“ç‰Œ Logo åŠ¨ç”»å’ŒåŠ è½½æ•ˆæœ
- ğŸ–¼ï¸ **åŠ¨æ€ä¸“è¾‘å°é¢**ï¼šåœ†å½¢å°é¢å®¹å™¨ï¼Œå®Œæ•´å›¾ç‰‡æ˜¾ç¤º
- ğŸ“± **é•¿æ–¹å½¢é€‚é…**ï¼šä¸“ä¸ºæ¨¡æ‹Ÿå™¨é•¿æ–¹å½¢å±å¹•ä¼˜åŒ–
- ğŸ­ **é«˜çº§æ ·å¼ç³»ç»Ÿ**ï¼šç£¨ç ‚ç»ç’ƒã€æ¸å˜ã€éœ“è™¹è“ä¸»é¢˜
- ğŸ“œ **æ™ºèƒ½æ’­æ”¾åˆ—è¡¨**ï¼šæœç´¢ã€æ’åºã€åŠ¨ç”»æ•ˆæœ
- ğŸ›ï¸ **ä¸“ä¸šéŸ³é‡æ¡**ï¼šå¯è§†åŒ–éŸ³é‡æ§åˆ¶
- ğŸ“Š **æ»šåŠ¨æ­Œæ›²ä¿¡æ¯**ï¼šé•¿æ ‡é¢˜è‡ªåŠ¨æ»šåŠ¨æ˜¾ç¤º

### ç³»ç»ŸåŠŸèƒ½
- ğŸŒ Wi-Fi ç½‘ç»œè¿æ¥ç®¡ç†
- ğŸ“ å®Œæ•´æ–‡ä»¶ç³»ç»Ÿé›†æˆ
- ğŸ”§ JSON é…ç½®æ–‡ä»¶ç®¡ç†
- ğŸ“Š ç³»ç»Ÿèµ„æºå®æ—¶ç›‘æ§
- ğŸ—ï¸ æ¨¡å—åŒ–æ¶æ„è®¾è®¡
- âš¡ é«˜æ€§èƒ½éŸ³é¢‘è§£ç ï¼ˆlibmadï¼‰

## ğŸ”§ ç³»ç»Ÿè¦æ±‚

### ç¡¬ä»¶è¦æ±‚
- **å¤„ç†å™¨**ï¼šARM Cortex-A7 æˆ–æ›´é«˜
- **å†…å­˜**ï¼šè‡³å°‘ 128MB RAM
- **å­˜å‚¨**ï¼šè‡³å°‘ 256MB é—ªå­˜
- **æ˜¾ç¤º**ï¼š1280x800 åˆ†è¾¨ç‡è§¦æ‘¸å±
- **éŸ³é¢‘**ï¼šPCM éŸ³é¢‘è¾“å‡ºæ”¯æŒ

### è½¯ä»¶è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**ï¼šOpenVela
- **å›¾å½¢åº“**ï¼šLVGL 8.x
- **éŸ³é¢‘åº“**ï¼šNuttX Audio æ¡†æ¶
- **ç½‘ç»œ**ï¼šWi-Fi é©±åŠ¨æ”¯æŒ

### å¼€å‘ç¯å¢ƒ
- **ç¼–è¯‘å™¨**ï¼šarm-none-eabi-gcc
- **æ„å»ºç³»ç»Ÿ**ï¼šMake
- **è°ƒè¯•å·¥å…·**ï¼šADB
- **ä¸»æœºç³»ç»Ÿ**ï¼šLinux (æ¨è Ubuntu 22.04)

## ğŸ“ é¡¹ç›®ç»“æ„

```
music_player/
â”œâ”€â”€ æ ¸å¿ƒæ¨¡å—/                      # ä¸»è¦åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ music_player.c           # ä¸»åº”ç”¨é€»è¾‘å’Œè½¦è½½UIç•Œé¢
â”‚   â”œâ”€â”€ music_player.h           # ä¸»åº”ç”¨å¤´æ–‡ä»¶å’Œæ•°æ®ç»“æ„
â”‚   â”œâ”€â”€ music_player_main.c      # åº”ç”¨ç¨‹åºå…¥å£ç‚¹
â”‚   â”œâ”€â”€ splash_screen.c          # å¯åŠ¨é¡µé¢æ¨¡å—ï¼ˆç‹¬ç«‹ï¼‰
â”‚   â”œâ”€â”€ playlist_manager.c       # æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ï¼ˆç‹¬ç«‹ï¼‰
â”‚   â””â”€â”€ playlist_manager.h       # æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨å¤´æ–‡ä»¶
â”œâ”€â”€ éŸ³é¢‘å¤„ç†æ¨¡å—/                  # éŸ³é¢‘ç›¸å…³ä»£ç 
â”‚   â”œâ”€â”€ audio_ctl.c              # éŸ³é¢‘æ§åˆ¶æ¨¡å—ï¼ˆæ”¯æŒMP3/WAVï¼‰
â”‚   â””â”€â”€ audio_ctl.h              # éŸ³é¢‘æ§åˆ¶å¤´æ–‡ä»¶
â”œâ”€â”€ ç½‘ç»œæ¨¡å—/                      # ç½‘ç»œè¿æ¥ä»£ç 
â”‚   â”œâ”€â”€ wifi.c                   # Wi-Fi ç®¡ç†æ¨¡å—
â”‚   â””â”€â”€ wifi.h                   # Wi-Fi ç®¡ç†å¤´æ–‡ä»¶
â”œâ”€â”€ res/                         # èµ„æºæ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ fonts/                   # å­—ä½“æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ MiSans-Normal.ttf   # å¸¸è§„å­—ä½“
â”‚   â”‚   â””â”€â”€ MiSans-Semibold.ttf # åŠç²—ä½“å­—ä½“
â”‚   â”œâ”€â”€ icons/                   # å›¾æ ‡æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ logo_vinyl.png      # å¯åŠ¨é¡µé¢æ—‹è½¬Logo
â”‚   â”‚   â”œâ”€â”€ music_page.png      # ç»Ÿä¸€ä¸“è¾‘å°é¢
â”‚   â”‚   â”œâ”€â”€ audio.png           # éŸ³é¢‘å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ music.png           # éŸ³ä¹å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ mute.png            # é™éŸ³å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ next.png            # ä¸‹ä¸€é¦–å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ nocover.png         # æ— å°é¢å ä½å›¾
â”‚   â”‚   â”œâ”€â”€ pause.png           # æš‚åœå›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ play.png            # æ’­æ”¾å›¾æ ‡
â”‚   â”‚   â”œâ”€â”€ playlist.png        # æ’­æ”¾åˆ—è¡¨å›¾æ ‡
â”‚   â”‚   â””â”€â”€ previous.png        # ä¸Šä¸€é¦–å›¾æ ‡
â”‚   â”œâ”€â”€ musics/                  # éŸ³ä¹æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ manifest.json       # éŸ³ä¹åˆ—è¡¨é…ç½®ï¼ˆæ›´æ–°ç‰ˆï¼‰
â”‚   â”‚   â”œâ”€â”€ *.mp3               # MP3éŸ³é¢‘æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ *.wav               # WAVéŸ³é¢‘æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ music_page.png      # ä¸“è¾‘å°é¢
â”‚   â””â”€â”€ config.json             # å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆWi-Fiç­‰ï¼‰
â”œâ”€â”€ æ„å»ºé…ç½®/                      # æ„å»ºç³»ç»Ÿæ–‡ä»¶
â”‚   â”œâ”€â”€ Kconfig                 # å†…æ ¸é…ç½®é€‰é¡¹
â”‚   â”œâ”€â”€ Makefile                # ä¸»æ„å»ºæ–‡ä»¶ï¼ˆåŒ…å«æ–°æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ Make.defs               # æ„å»ºå®šä¹‰
â”‚   â””â”€â”€ Make.dep                # æ„å»ºä¾èµ–
â”œâ”€â”€ æ–‡æ¡£/                          # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md               # ä¸»è¦æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚   â”œâ”€â”€ MP3_SUPPORT.md          # MP3æ”¯æŒè¯¦ç»†è¯´æ˜
â”‚   â””â”€â”€ docs_png/               # æ–‡æ¡£å›¾ç‰‡èµ„æº
â””â”€â”€ scripts/                     # è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
    â”œâ”€â”€ run_music_player_gui.sh     # GUIæ¨¡å¼å¯åŠ¨è„šæœ¬
    â”œâ”€â”€ run_music_player_headless.sh # æ— å¤´æ¨¡å¼å¯åŠ¨è„šæœ¬
    â”œâ”€â”€ fix_mp3_playback.sh         # MP3é—®é¢˜è¯Šæ–­ä¿®å¤è„šæœ¬
    â””â”€â”€ test_mp3_complete.sh        # å®Œæ•´MP3æµ‹è¯•è„šæœ¬
```

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

#### 1. music_player.c/h - ä¸»åº”ç”¨æ¨¡å—
- **åŠŸèƒ½**ï¼šåº”ç”¨ç¨‹åºä¸»é€»è¾‘å’Œè½¦è½½UIç•Œé¢
- **èŒè´£**ï¼šè½¦è½½UIç®¡ç†ã€çŠ¶æ€æ§åˆ¶ã€äº‹ä»¶å¤„ç†ã€æ—¶é—´æ—¥æœŸæ˜¾ç¤º
- **å…³é”®ç‰¹æ€§**ï¼š
  - ç°ä»£åŒ–è½¦è½½ç•Œé¢è®¾è®¡ï¼ˆæ·±ç©ºç°èƒŒæ™¯ã€éœ“è™¹è“ä¸»é¢˜ï¼‰
  - é¡¶éƒ¨çŠ¶æ€æ ï¼ˆWi-Fiã€ç”µæ± ã€æ—¶é—´ã€æ—¥æœŸï¼‰
  - åœ†å½¢ä¸“è¾‘å°é¢å®¹å™¨ï¼Œå®Œæ•´å›¾ç‰‡æ˜¾ç¤º
  - æ»šåŠ¨æ­Œæ›²ä¿¡æ¯æ˜¾ç¤º
  - é«˜çº§æ ·å¼ç³»ç»Ÿï¼ˆç£¨ç ‚ç»ç’ƒã€æ¸å˜æ•ˆæœï¼‰
- **å…³é”®ç»“æ„**ï¼š
  - `struct ctx_s`ï¼šè¿è¡Œæ—¶ä¸Šä¸‹æ–‡
  - `struct resource_s`ï¼šUI èµ„æºç®¡ç†
  - `album_info_t`ï¼šä¸“è¾‘ä¿¡æ¯ç»“æ„

#### 2. splash_screen.c - å¯åŠ¨é¡µé¢æ¨¡å—ï¼ˆç‹¬ç«‹ï¼‰
- **åŠŸèƒ½**ï¼šå“ç‰Œå¯åŠ¨é¡µé¢å’ŒåŠ è½½åŠ¨ç”»
- **èŒè´£**ï¼šåº”ç”¨å¯åŠ¨æ—¶çš„å“ç‰Œå±•ç¤ºå’Œç”¨æˆ·ä½“éªŒ
- **å…³é”®ç‰¹æ€§**ï¼š
  - "Vela Audio" å“ç‰ŒLogoæ˜¾ç¤º
  - "Music Connects Souls" æ ‡è¯­
  - æ—‹è½¬å”±ç‰‡åŠ¨ç”»æ•ˆæœ
  - æ·¡å…¥æ·¡å‡ºåŠ¨ç”»è¿‡æ¸¡
  - è‡ªåŠ¨è·³è½¬åˆ°ä¸»ç•Œé¢

#### 3. playlist_manager.c/h - æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ï¼ˆç‹¬ç«‹ï¼‰
- **åŠŸèƒ½**ï¼šä¸“ä¸šæ’­æ”¾åˆ—è¡¨ç®¡ç†
- **èŒè´£**ï¼šæ’­æ”¾åˆ—è¡¨æ˜¾ç¤ºã€æœç´¢ã€æ’åºã€äº¤äº’
- **å…³é”®ç‰¹æ€§**ï¼š
  - å…¨å±ç£¨ç ‚ç»ç’ƒèƒŒæ™¯
  - æœç´¢æ å’Œæ’åºæŒ‰é’®
  - åŠ¨ç”»è¿›å…¥å’Œé€€å‡ºæ•ˆæœ
  - å½“å‰æ’­æ”¾æ­Œæ›²æŒ‡ç¤ºå™¨ï¼ˆâ™ªï¼‰
  - æ‚¬åœå’Œç‚¹å‡»äº¤äº’æ•ˆæœ

#### 4. audio_ctl.c/h - éŸ³é¢‘å¤„ç†æ¨¡å—
- **åŠŸèƒ½**ï¼šå¤šæ ¼å¼éŸ³é¢‘æ§åˆ¶æ¨¡å—
- **èŒè´£**ï¼šéŸ³é¢‘æ’­æ”¾ã€æš‚åœã€åœæ­¢ã€éŸ³é‡æ§åˆ¶ã€æ ¼å¼è§£ç 
- **æ”¯æŒæ ¼å¼**ï¼šMP3ï¼ˆlibmadï¼‰ã€WAV éŸ³é¢‘æ–‡ä»¶
- **å…³é”®ç‰¹æ€§**ï¼š
  - è‡ªåŠ¨æ ¼å¼æ£€æµ‹
  - é«˜è´¨é‡MP3è§£ç 
  - å®æ—¶æµå¼å¤„ç†
  - ä½å†…å­˜å ç”¨è®¾è®¡
- **æ¥å£**ï¼šNuttX Audio æ¡†æ¶

#### 5. wifi.c/h - ç½‘ç»œæ¨¡å—
- **åŠŸèƒ½**ï¼šWi-Fi è¿æ¥ç®¡ç†
- **èŒè´£**ï¼šç½‘ç»œè¿æ¥ã€é…ç½®ç®¡ç†
- **é…ç½®**ï¼šåŸºäº config.jsonï¼ˆå·²æ›´æ–°ä¸ºvela_networkï¼‰

#### 6. èµ„æºæ–‡ä»¶ç®¡ç†
- **å­—ä½“**ï¼šLVGLå†…ç½® Montserrat å­—ä½“ç³»åˆ—
- **å›¾æ ‡**ï¼šè½¦è½½é£æ ¼ PNG å›¾æ ‡ï¼ŒåŒ…å«å¯åŠ¨Logo
- **éŸ³é¢‘**ï¼šMP3/WAV æ ¼å¼éŸ³ä¹æ–‡ä»¶
- **é…ç½®**ï¼šJSON æ ¼å¼é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«éŸ³ä¹å…ƒæ•°æ®

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…å¿…è¦çš„å·¥å…·
sudo apt update
sudo apt install -y android-tools-adb build-essential git

# å…‹éš† OpenVela ä»“åº“
git clone <openvela-repo-url>
cd vela_code
```

### 2. é…ç½®é¡¹ç›®

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd /root/vela_code

# é…ç½®éŸ³ä¹æ’­æ”¾å™¨
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap menuconfig

# æˆ–è€…ç›´æ¥ç¼–è¾‘é…ç½®æ–‡ä»¶
echo "CONFIG_LVX_USE_DEMO_MUSIC_PLAYER=y" >> vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap/defconfig
echo 'CONFIG_LVX_MUSIC_PLAYER_DATA_ROOT="/data"' >> vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap/defconfig
```

### 3. ç¼–è¯‘é¡¹ç›®

```bash
# æ¸…ç†æ„å»ºäº§ç‰©
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap distclean -j8

# å¼€å§‹æ„å»º
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap -j8
```

### 4. å¯åŠ¨æ¨¡æ‹Ÿå™¨

```bash
# åˆ›å»º nuttx ç¬¦å·é“¾æ¥ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
cd nuttx && ln -sf vela_ap.elf nuttx && cd ..

# å¯åŠ¨æ¨¡æ‹Ÿå™¨
./emulator.sh vela
```

#### 4.2 æœ‰æ˜¾ç¤ºç¯å¢ƒçš„ä¸€é”®å¯åŠ¨æ–¹æ¡ˆï¼ˆGUIï¼‰- æ¨è

```bash
# ä»ä»“åº“æ ¹ç›®å½•æ‰§è¡Œï¼ˆè‡ªåŠ¨ï¼šé…ç½®â†’æ„å»ºâ†’çª—å£æ¨¡å¼å¯åŠ¨â†’æ¨é€èµ„æºâ†’è¿è¡Œæ’­æ”¾å™¨ï¼‰
scripts/run_music_player_gui.sh
```

è¯¥è„šæœ¬å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
- è‡ªåŠ¨é…ç½®æ„å»ºé€‰é¡¹ï¼ˆå¯ç”¨å†…å»ºåº”ç”¨ã€NSH å†…å»ºåº”ç”¨ã€éŸ³ä¹æ’­æ”¾å™¨ã€MP3æ”¯æŒï¼‰
- è®¾ç½®èµ„æºæ ¹ç›®å½•ä¸º `/root/vela_code/apps/packages/demos/music_player`
- æŒ‰ goldfish-armeabi-v7a-ap é…ç½®æ¸…ç†å¹¶æ„å»ºç³»ç»Ÿ
- **å¯åŠ¨é¡µé¢åŠŸèƒ½**ï¼šåŒ…å«Vela Audioå“ç‰Œå¯åŠ¨é¡µé¢å’ŒåŠ¨ç”»
- çª—å£æ¨¡å¼å¯åŠ¨æ¨¡æ‹Ÿå™¨ï¼ˆéœ€è¦ä¸»æœºå…·å¤‡ X11/Qt xcb ç¯å¢ƒï¼‰
- é€šè¿‡ ADB æ¨é€éŸ³ä¹æ’­æ”¾å™¨èµ„æºåˆ° `/data/res`
- åå°å¯åŠ¨ `music_player` å¹¶è¿›è¡Œè¿›ç¨‹æ ¡éªŒ
- **æ–°åŠŸèƒ½**ï¼šè‡ªåŠ¨å¯ç”¨MP3æ”¯æŒå’Œlibmadåº“

æ–°å¢ç‰¹æ€§ï¼š
- âœ… **MP3 æ”¯æŒ**ï¼šå·²è‡ªåŠ¨å¯ç”¨ `CONFIG_LVX_MUSIC_PLAYER_MP3_SUPPORT=y` å’Œ `CONFIG_LIB_MAD=y`
- ğŸŒŸ **å¯åŠ¨é¡µé¢**ï¼šåŒ…å«å“ç‰ŒLogoå’ŒåŠ è½½åŠ¨ç”»
- ğŸ›ï¸ **é«˜çº§æ’­æ”¾åˆ—è¡¨**ï¼šç‹¬ç«‹æ¨¡å—åŒ–æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨
- ğŸš— **è½¦è½½ç•Œé¢**ï¼šç°ä»£åŒ–è½¦è½½é£æ ¼UIè®¾è®¡

æ³¨æ„ï¼š
- å¦‚æœå‡ºç°æ˜¾å¡å…¼å®¹æ€§é—®é¢˜ï¼Œå¯å°†è„šæœ¬ä¸­çš„ `-gpu swiftshader_indirect` æ”¹ä¸º `-gpu off` æˆ–æ ¹æ®ä¸»æœºç¯å¢ƒè°ƒæ•´ã€‚
- è„šæœ¬å·²åŒ…å«MP3æ”¯æŒï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚

#### 4.3 æ— å¤´æ¨¡å¼å¯åŠ¨æ–¹æ¡ˆ

```bash
# åå°è¿è¡Œï¼Œä¸éœ€è¦å›¾å½¢ç¯å¢ƒ
scripts/run_music_player_headless.sh
```

### 5. éƒ¨ç½²èµ„æº

```bash
# ç­‰å¾…æ¨¡æ‹Ÿå™¨å¯åŠ¨
sleep 15

# è¿æ¥ ADB
adb connect 127.0.0.1:5555

# æ¨é€èµ„æºæ–‡ä»¶
adb -s emulator-5554 push apps/packages/demos/music_player/res /data/
```

### 6. è¿è¡Œåº”ç”¨

```bash
# é€šè¿‡ ADB Shell å¯åŠ¨éŸ³ä¹æ’­æ”¾å™¨
adb -s emulator-5554 shell "music_player &"
```

## âš™ï¸ é…ç½®è¯´æ˜

### config.json é…ç½®ï¼ˆå·²æ›´æ–°ï¼‰

```json
{
  "wifi": {
    "ssid": "vela_network",       // Wi-Fi ç½‘ç»œåç§°ï¼ˆå·²æ›´æ–°ï¼‰
    "pswd": "vela123456"          // Wi-Fi å¯†ç ï¼ˆå·²æ›´æ–°ï¼‰
  }
}
```

**æ³¨æ„**ï¼šå·²ä»"BenignX"æ›´æ–°ä¸º"Vela"å“ç‰Œã€‚è¯·å‹¿åœ¨ä»£ç ä¸­ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯ï¼Œå»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡æˆ–å®‰å…¨å­˜å‚¨æ–¹å¼åŠ è½½ã€‚

### manifest.json éŸ³ä¹é…ç½®ï¼ˆå·²ä¼˜åŒ–ï¼‰

```json
{
  "musics": [
    {
      "path": "Let Her Go.mp3",       // æ”¯æŒMP3æ ¼å¼
      "name": "Let Her Go",           // æ­Œæ›²åç§°
      "artist": "Passenger",          // çœŸå®è‰ºæœ¯å®¶åç§°
      "cover": "music_page.png",      // ç»Ÿä¸€ä¸“è¾‘å°é¢
      "total_time": 253000,           // æ€»æ—¶é•¿ï¼ˆæ¯«ç§’ï¼‰
      "color": "#FF5722"              // ä¸»é¢˜é¢œè‰²
    },
    {
      "path": "Love Story.mp3",
      "name": "Love Story", 
      "artist": "Taylor Swift",
      "cover": "music_page.png",
      "total_time": 236000,
      "color": "#9C27B0"
    },
    {
      "path": "Levitating.mp3",
      "name": "Levitating",
      "artist": "Dua Lipa", 
      "cover": "music_page.png",
      "total_time": 203000,
      "color": "#2196F3"
    }
  ]
}
```

**æ›´æ–°å†…å®¹**ï¼š
- âœ… æ”¯æŒ MP3 æ ¼å¼éŸ³é¢‘æ–‡ä»¶
- âœ… ä½¿ç”¨çœŸå®è‰ºæœ¯å®¶åç§°ï¼ˆä¸å†ä½¿ç”¨"BenignX"ï¼‰
- âœ… ç»Ÿä¸€ä½¿ç”¨ `music_page.png` ä½œä¸ºä¸“è¾‘å°é¢
- âœ… æ›´æ–°äº†çœŸå®çš„æ­Œæ›²æ—¶é•¿

### Kconfig é…ç½®é€‰é¡¹ï¼ˆå·²æ‰©å±•ï¼‰

```kconfig
# åŸºç¡€é…ç½®
CONFIG_LVX_USE_DEMO_MUSIC_PLAYER=y             # å¯ç”¨éŸ³ä¹æ’­æ”¾å™¨
CONFIG_LVX_MUSIC_PLAYER_DATA_ROOT="/root/vela_code/apps/packages/demos/music_player" # æ•°æ®æ ¹ç›®å½•
CONFIG_LVX_MUSIC_PLAYER_STACKSIZE=40960        # åº”ç”¨æ ˆå¤§å°ï¼ˆå·²ä¼˜åŒ–ï¼‰
CONFIG_LVX_MUSIC_PLAYER_PRIORITY=100           # åº”ç”¨ä¼˜å…ˆçº§

# MP3 æ”¯æŒé…ç½®ï¼ˆæ–°å¢ï¼‰
CONFIG_LVX_MUSIC_PLAYER_MP3_SUPPORT=y          # å¯ç”¨MP3æ ¼å¼æ”¯æŒ
CONFIG_LVX_MUSIC_PLAYER_MP3_BUFFER_SIZE=8192   # MP3è§£ç ç¼“å†²åŒºå¤§å°
CONFIG_LIB_MAD=y                               # å¯ç”¨libmad MP3è§£ç åº“

# LVGL å›¾å½¢é…ç½®
CONFIG_GRAPHICS_LVGL=y                         # å¯ç”¨LVGLå›¾å½¢åº“
CONFIG_LV_COLOR_DEPTH_32=y                     # 32ä½é¢œè‰²æ·±åº¦
CONFIG_LV_USE_CLIB_MALLOC=y                    # ä½¿ç”¨Cåº“å†…å­˜ç®¡ç†
CONFIG_LV_USE_CLIB_SPRINTF=y                   # ä½¿ç”¨Cåº“å­—ç¬¦ä¸²æ ¼å¼åŒ–
CONFIG_LV_USE_CLIB_STRING=y                    # ä½¿ç”¨Cåº“å­—ç¬¦ä¸²å¤„ç†
CONFIG_LV_USE_LOG=y                            # å¯ç”¨LVGLæ—¥å¿—
CONFIG_LV_USE_NUTTX=y                          # å¯ç”¨NuttXå¹³å°æ”¯æŒ
CONFIG_LV_USE_NUTTX_TOUCHSCREEN=y              # å¯ç”¨è§¦å±æ”¯æŒ

# LVGL å­—ä½“é…ç½®
CONFIG_LV_FONT_MONTSERRAT_16=y                 # 16å·å­—ä½“
CONFIG_LV_FONT_MONTSERRAT_22=y                 # 22å·å­—ä½“  
CONFIG_LV_FONT_MONTSERRAT_24=y                 # 24å·å­—ä½“
CONFIG_LV_FONT_MONTSERRAT_28=y                 # 28å·å­—ä½“
CONFIG_LV_FONT_MONTSERRAT_48=y                 # 48å·å­—ä½“

# ç³»ç»Ÿæ”¯æŒé…ç½®
CONFIG_BUILTIN=y                               # å¯ç”¨å†…å»ºåº”ç”¨æ”¯æŒ
CONFIG_NSH_BUILTIN_APPS=y                      # å¯ç”¨NSHå†…å»ºåº”ç”¨
CONFIG_SYSTEM_NSH=y                            # å¯ç”¨NSHç³»ç»Ÿ
CONFIG_SYSTEM_BUILTIN=y                        # å¯ç”¨å†…å»ºåº”ç”¨ç³»ç»Ÿ
```

## ğŸ”¨ æ„å»ºæŒ‡å—

### æ„å»ºç³»ç»Ÿæ¦‚è¿°

é¡¹ç›®ä½¿ç”¨ NuttX æ„å»ºç³»ç»Ÿï¼ŒåŒ…å«ä»¥ä¸‹å…³é”®æ–‡ä»¶ï¼š

#### Makefile
```makefile
include $(APPDIR)/Make.defs

ifeq ($(CONFIG_LVX_USE_DEMO_MUSIC_PLAYER), y)
PROGNAME = music_player          # ç¨‹åºåç§°
PRIORITY = 100                   # ä¼˜å…ˆçº§
STACKSIZE = 40960               # æ ˆå¤§å°ï¼ˆå­—èŠ‚ï¼‰
MODULE = $(CONFIG_LVX_USE_DEMO_MUSIC_PLAYER)

CSRCS = music_player.c audio_ctl.c wifi.c splash_screen.c playlist_manager.c     # Cæºæ–‡ä»¶ï¼ˆå·²æ‰©å±•ï¼‰
MAINSRC = music_player_main.c                  # ä¸»å…¥å£æ–‡ä»¶
endif

include $(APPDIR)/Application.mk
```

#### Make.defs
```makefile
ifneq ($(CONFIG_LVX_USE_DEMO_MUSIC_PLAYER),)
CONFIGURED_APPS += $(APPDIR)/packages/demos/music_player
endif
```

### æ„å»ºé€‰é¡¹

#### è°ƒè¯•ç‰ˆæœ¬
```bash
# å¯ç”¨è°ƒè¯•ç¬¦å·
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap DEBUG=1 -j8
```

#### å‘å¸ƒç‰ˆæœ¬
```bash
# ä¼˜åŒ–æ„å»º
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap OPTIMIZE=2 -j8
```

#### æ¸…ç†æ„å»º
```bash
# å®Œå…¨æ¸…ç†
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap distclean

# ä»…æ¸…ç†éŸ³ä¹æ’­æ”¾å™¨
make -C apps/packages/demos/music_player clean
```

### æ„å»ºäº§ç‰©

æˆåŠŸæ„å»ºåä¼šç”Ÿæˆï¼š
- `nuttx/vela_ap.elf`ï¼šä¸»å¯æ‰§è¡Œæ–‡ä»¶
- `nuttx/vela_ap.bin`ï¼šäºŒè¿›åˆ¶æ˜ åƒ
- `nuttx/vela_system.bin`ï¼šç³»ç»Ÿæ˜ åƒ
- `nuttx/vela_data.bin`ï¼šæ•°æ®æ˜ åƒ

## ğŸš¢ éƒ¨ç½²è¿è¡Œ

### æ¨¡æ‹Ÿå™¨éƒ¨ç½²

#### 1. å¯åŠ¨æ¨¡æ‹Ÿå™¨
```bash
# å¯åŠ¨ QEMU æ¨¡æ‹Ÿå™¨
./emulator.sh vela

# æ£€æŸ¥æ¨¡æ‹Ÿå™¨çŠ¶æ€
ps aux | grep qemu
```

#### 2. ADB è¿æ¥
```bash
# æ£€æŸ¥ ADB æœåŠ¡
adb devices

# è¿æ¥åˆ°æ¨¡æ‹Ÿå™¨
adb connect 127.0.0.1:5555

# éªŒè¯è¿æ¥
adb -s emulator-5554 shell uname -a
```

#### 3. æ–‡ä»¶ä¼ è¾“
```bash
# åˆ›å»ºç›®æ ‡ç›®å½•
adb -s emulator-5554 shell mkdir -p /data/res

# æ¨é€èµ„æºæ–‡ä»¶
adb -s emulator-5554 push res/ /data/

# éªŒè¯æ–‡ä»¶
adb -s emulator-5554 shell ls -la /data/res/
```

### ç¡¬ä»¶è®¾å¤‡éƒ¨ç½²

#### 1. ä¸²å£è¿æ¥
```bash
# é…ç½®ä¸²å£è¿æ¥
minicom -s
# è®¾ç½®ï¼š115200 8N1ï¼Œæ— æµæ§

# æˆ–ä½¿ç”¨ screen
screen /dev/ttyUSB0 115200
```

#### 2. ç½‘ç»œéƒ¨ç½²
```bash
# é…ç½®ç½‘ç»œå¯åŠ¨
setenv serverip 192.168.1.100
setenv ipaddr 192.168.1.200
tftp 0x40000000 vela_ap.bin
go 0x40000000
```

#### 3. å­˜å‚¨éƒ¨ç½²
```bash
# çƒ§å½•åˆ° Flash
flash erase 0x00000000 0x00800000
flash write 0x40000000 0x00000000 0x00800000
```

### è¿è¡Œæ—¶ç›‘æ§

#### 1. ç³»ç»Ÿç›‘æ§
```bash
# æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
adb shell ps
adb shell free
adb shell df -h

# æŸ¥çœ‹æ—¥å¿—
adb shell dmesg
adb logcat
```

#### 2. åº”ç”¨ç›‘æ§
```bash
# æ£€æŸ¥éŸ³ä¹æ’­æ”¾å™¨è¿›ç¨‹
adb shell ps | grep music_player

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
adb shell tail -f /var/log/music_player.log
```

#### 3. æ€§èƒ½åˆ†æ
```bash
# CPU ä½¿ç”¨ç‡
adb shell top -p $(adb shell pidof music_player)

# å†…å­˜ä½¿ç”¨
adb shell cat /proc/$(adb shell pidof music_player)/status
```

## ğŸ¨ è‡ªå®šä¹‰æŒ‡å—

### æ·»åŠ æ–°éŸ³ä¹

#### 1. å‡†å¤‡éŸ³é¢‘æ–‡ä»¶
```bash
# è½¬æ¢éŸ³é¢‘æ ¼å¼ï¼ˆå¦‚æœéœ€è¦ï¼‰
ffmpeg -i input.mp3 -acodec pcm_s16le -ar 44100 -ac 2 output.wav

# å‡†å¤‡ä¸“è¾‘å°é¢ï¼ˆæ¨è 300x300ï¼‰
convert cover.jpg -resize 300x300 cover.png
```

#### 2. æ›´æ–°é…ç½®æ–‡ä»¶
```json
{
  "musics": [
    {
      "path": "new_song.wav",
      "name": "æ–°æ­Œåç§°",
      "artist": "è‰ºæœ¯å®¶åç§°",
      "cover": "new_cover.png",
      "total_time": 240000,
      "color": "#FF5722"
    }
  ]
}
```

#### 3. éƒ¨ç½²æ–‡ä»¶
```bash
# å¤åˆ¶æ–‡ä»¶åˆ°èµ„æºç›®å½•
cp new_song.wav res/musics/
cp new_cover.png res/musics/

# æ¨é€åˆ°è®¾å¤‡
adb push res/musics/ /data/res/musics/
```

### è‡ªå®šä¹‰ç•Œé¢

#### 1. ä¿®æ”¹ä¸»é¢˜é¢œè‰²
```c
// åœ¨ music_player.c ä¸­ä¿®æ”¹
#define THEME_PRIMARY_COLOR   lv_color_hex(0x2196F3)
#define THEME_SECONDARY_COLOR lv_color_hex(0xFF5722)
#define THEME_BACKGROUND_COLOR lv_color_hex(0x121212)
```

#### 2. è°ƒæ•´ç•Œé¢å¸ƒå±€
```c
// ä¿®æ”¹åˆ†è¾¨ç‡é€‚é…
#define SCREEN_WIDTH  1280
#define SCREEN_HEIGHT 800
#define UI_SCALE_FACTOR 1.0f

// è°ƒæ•´æ§ä»¶å¤§å°
#define ALBUM_COVER_SIZE 300
#define BUTTON_SIZE 60
#define PROGRESS_BAR_HEIGHT 8
```

#### 3. æ·»åŠ æ–°åŠŸèƒ½
```c
// æ·»åŠ å‡è¡¡å™¨åŠŸèƒ½
typedef struct {
    int8_t bass;
    int8_t middle;
    int8_t treble;
} equalizer_t;

static void app_equalizer_apply(equalizer_t* eq) {
    // å®ç°å‡è¡¡å™¨é€»è¾‘
}
```

### æ‰©å±•éŸ³é¢‘æ ¼å¼

#### 1. MP3 æ”¯æŒï¼ˆå·²å®ç°ï¼‰

éŸ³ä¹æ’­æ”¾å™¨ç°å·²æ”¯æŒMP3æ ¼å¼ï¼è¦å¯ç”¨MP3æ”¯æŒï¼Œéœ€è¦ï¼š

**å¯ç”¨é…ç½®é€‰é¡¹ï¼š**
```bash
# åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨
CONFIG_LVX_MUSIC_PLAYER_MP3_SUPPORT=y
CONFIG_LVX_MUSIC_PLAYER_MP3_BUFFER_SIZE=8192
CONFIG_LIB_MAD=y  # ç¡®ä¿libmadåº“å¯ç”¨
```

**æ”¯æŒçš„åŠŸèƒ½ï¼š**
- âœ… MP3æ–‡ä»¶è‡ªåŠ¨æ£€æµ‹ï¼ˆåŸºäºæ–‡ä»¶æ‰©å±•åï¼‰
- âœ… ä½¿ç”¨libmadè¿›è¡Œé«˜è´¨é‡MP3è§£ç 
- âœ… æ”¯æŒå„ç§é‡‡æ ·ç‡å’Œæ¯”ç‰¹ç‡
- âœ… ç«‹ä½“å£°å’Œå•å£°é“æ”¯æŒ
- âœ… å®æ—¶æµå¼è§£ç ï¼Œå†…å­˜å ç”¨ä½

**ä½¿ç”¨æ–¹æ³•ï¼š**
```json
// åœ¨manifest.jsonä¸­æ·»åŠ MP3æ–‡ä»¶
{
  "path": "song.mp3",
  "name": "My MP3 Song",
  "artist": "Artist Name",
  "cover": "cover.png",
  "total_time": 240000,
  "color": "#FF5722"
}
```

**æŠ€æœ¯å®ç°ï¼š**
```c
// éŸ³é¢‘æ ¼å¼è‡ªåŠ¨æ£€æµ‹
int format = audio_ctl_detect_format(filename);

// MP3è§£ç å™¨åˆå§‹åŒ–
#ifdef CONFIG_LVX_MUSIC_PLAYER_MP3_SUPPORT
mp3_decoder_s decoder;
mp3_decoder_init(&decoder);

// è§£ç MP3æ•°æ®åˆ°PCM
mp3_decoder_decode(&decoder, input_data, input_size, 
                   output_pcm, &output_size);
#endif
```

#### 2. æ·»åŠ å…¶ä»–éŸ³é¢‘æ ¼å¼æ”¯æŒ

æ‚¨å¯ä»¥å‚è€ƒMP3å®ç°æ¥æ·»åŠ å…¶ä»–æ ¼å¼ï¼š

```c
// æ·»åŠ AACæ”¯æŒç¤ºä¾‹
#ifdef CONFIG_LVX_MUSIC_PLAYER_AAC_SUPPORT
#include <faad.h>

typedef struct aac_decoder {
    faacDecHandle handle;
    // ... AACç‰¹å®šå­—æ®µ
} aac_decoder_s;

int aac_decoder_init(aac_decoder_s *decoder) {
    decoder->handle = faacDecOpen();
    // ... åˆå§‹åŒ–é€»è¾‘
}
#endif
```

#### 3. é…ç½®æ„å»ºç³»ç»Ÿ
```kconfig
# ç°æœ‰çš„MP3é…ç½®
config LVX_MUSIC_PLAYER_MP3_SUPPORT
    bool "Enable MP3 audio format support"
    default n
    depends on LIB_MAD
    
config LVX_MUSIC_PLAYER_MP3_BUFFER_SIZE
    int "MP3 decode buffer size"
    default 8192
    depends on LVX_MUSIC_PLAYER_MP3_SUPPORT
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. ç¼–è¯‘é”™è¯¯

**é—®é¢˜**ï¼š`music_player: command not found`
```bash
# è§£å†³æ–¹æ¡ˆï¼šæ£€æŸ¥é…ç½®
grep -r LVX_USE_DEMO_MUSIC_PLAYER vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap/defconfig

# é‡æ–°é…ç½®å’Œç¼–è¯‘
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap distclean
./build.sh vendor/openvela/boards/vela/configs/goldfish-armeabi-v7a-ap -j8
```

**é—®é¢˜**ï¼šæ ˆæº¢å‡ºé”™è¯¯
```bash
# è§£å†³æ–¹æ¡ˆï¼šå¢åŠ æ ˆå¤§å°
# ç¼–è¾‘ Makefile
STACKSIZE = 65536  # ä» 32768 å¢åŠ åˆ° 65536
```

#### 2. è¿è¡Œæ—¶é”™è¯¯

**é—®é¢˜**ï¼šæ‰¾ä¸åˆ°èµ„æºæ–‡ä»¶
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
adb shell ls -la /data/res/

# é‡æ–°æ¨é€èµ„æº
adb push res/ /data/
```

**é—®é¢˜**ï¼šéŸ³é¢‘æ’­æ”¾å¤±è´¥
```bash
# æ£€æŸ¥éŸ³é¢‘è®¾å¤‡
adb shell ls -la /dev/audio/

# æ£€æŸ¥éŸ³é¢‘æ ¼å¼
file res/musics/*.wav
```

#### 3. æ¨¡æ‹Ÿå™¨é—®é¢˜

**é—®é¢˜**ï¼šæ¨¡æ‹Ÿå™¨å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥ nuttx æ–‡ä»¶
ls -la nuttx/nuttx

# é‡æ–°åˆ›å»ºç¬¦å·é“¾æ¥
cd nuttx && rm -f nuttx && ln -sf vela_ap.elf nuttx
```

**é—®é¢˜**ï¼šADB è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 555

# é‡æ–°è¿æ¥
adb disconnect 127.0.0.1:5555
adb connect 127.0.0.1:5555
```

### è°ƒè¯•æŠ€å·§

#### 1. ä½¿ç”¨æ—¥å¿—è¾“å‡º
```c
// æ·»åŠ è°ƒè¯•æ—¥å¿—
#define MUSIC_DEBUG 1

#if MUSIC_DEBUG
#define DLOG(fmt, ...) printf("[MUSIC] " fmt "\n", ##__VA_ARGS__)
#else
#define DLOG(fmt, ...)
#endif

// åœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—
DLOG("Loading audio file: %s", file_path);
DLOG("Audio playback started, duration: %lu ms", duration);
```

#### 2. ä½¿ç”¨ GDB è°ƒè¯•
```bash
# å¯åŠ¨ GDB æœåŠ¡å™¨
./emulator.sh vela -s -S

# è¿æ¥ GDB
arm-none-eabi-gdb nuttx/nuttx
(gdb) target remote localhost:1234
(gdb) b main
(gdb) c
```

#### 3. å†…å­˜åˆ†æ
```c
// æ·»åŠ å†…å­˜ä½¿ç”¨ç»Ÿè®¡
static void print_memory_usage(void) {
    struct mallinfo info = mallinfo();
    printf("Memory usage:\n");
    printf("  Total heap: %d bytes\n", info.arena);
    printf("  Used heap: %d bytes\n", info.uordblks);
    printf("  Free heap: %d bytes\n", info.fordblks);
}
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. ç•Œé¢ä¼˜åŒ–
```c
// å‡å°‘ä¸å¿…è¦çš„é‡ç»˜
lv_obj_add_flag(obj, LV_OBJ_FLAG_FLOATING);

// ä½¿ç”¨ç¼“å­˜æé«˜æ€§èƒ½
lv_obj_set_style_bg_opa(obj, LV_OPA_COVER, 0);
```

#### 2. éŸ³é¢‘ä¼˜åŒ–
```c
// ä¼˜åŒ–éŸ³é¢‘ç¼“å†²åŒºå¤§å°
#define AUDIO_BUFFER_SIZE (4096 * 4)  // 16KB ç¼“å†²åŒº

// ä½¿ç”¨DMAä¼ è¾“
static int audio_dma_setup(void) {
    // é…ç½® DMA éŸ³é¢‘ä¼ è¾“
}
```

#### 3. å†…å­˜ä¼˜åŒ–
```c
// é¢„åˆ†é…å†…å­˜æ± 
static uint8_t audio_buffer_pool[AUDIO_BUFFER_SIZE * 4];
static uint8_t ui_buffer_pool[UI_BUFFER_SIZE];

// ä½¿ç”¨å¯¹è±¡æ± ç®¡ç†
static album_info_t album_pool[MAX_ALBUMS];
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ¶æ„æ¦‚è§ˆ

![æ¶æ„æ¦‚è§ˆ](docs_png/æ¶æ„æ¦‚è§ˆ.png)

Vela é«˜çº§è½¦è½½éŸ³ä¹æ’­æ”¾å™¨é‡‡ç”¨ç°ä»£åŒ–æ¨¡å—åŒ–åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œä»ä¸‹åˆ°ä¸ŠåŒ…æ‹¬ï¼š

- **ç¡¬ä»¶æŠ½è±¡å±‚**ï¼šéŸ³é¢‘ç¡¬ä»¶ã€å­˜å‚¨è®¾å¤‡ã€ç½‘ç»œç¡¬ä»¶çš„åº•å±‚é©±åŠ¨
- **ç³»ç»ŸæŠ½è±¡å±‚ (NuttX)**ï¼šéŸ³é¢‘é©±åŠ¨ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæ ˆçš„ç³»ç»Ÿçº§æœåŠ¡  
- **éŸ³é¢‘è§£ç å±‚**ï¼šMP3è§£ç å™¨(libmad)ã€WAVè§£ç å™¨ã€æ ¼å¼è‡ªåŠ¨æ£€æµ‹
- **æœåŠ¡å±‚**ï¼šéŸ³é¢‘æ§åˆ¶ã€æ–‡ä»¶ç®¡ç†ã€Wi-Fiç®¡ç†ç­‰åº”ç”¨æœåŠ¡
- **ä¸šåŠ¡é€»è¾‘å±‚**ï¼šçŠ¶æ€ç®¡ç†ã€æ’­æ”¾æ§åˆ¶ã€æ’­æ”¾åˆ—è¡¨é€»è¾‘
- **UIæ¨¡å—å±‚**ï¼šå¯åŠ¨é¡µé¢æ¨¡å—ã€ä¸»ç•Œé¢æ¨¡å—ã€æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨æ¨¡å—
- **ç”¨æˆ·ç•Œé¢å±‚ (LVGL)**ï¼šè½¦è½½é£æ ¼å›¾å½¢ç•Œé¢æ¸²æŸ“å’Œè§¦å±äº¤äº’

### æ•°æ®æµå›¾

![æ•°æ®æµå›¾](docs_png/æ•°æ®æµå›¾.png)

ç³»ç»Ÿçš„æ•°æ®æµä¸»è¦åŒ…æ‹¬å››ä¸ªä¸»è¦è·¯å¾„ï¼š

1. **åº”ç”¨å¯åŠ¨æµ**ï¼š`main()` â†’ `splash_screen_create()` â†’ å¯åŠ¨åŠ¨ç”» â†’ `app_create()` â†’ ä¸»ç•Œé¢
2. **ç”¨æˆ·äº¤äº’æµ**ï¼šç”¨æˆ·æ“ä½œ â†’ äº‹ä»¶å¤„ç† â†’ çŠ¶æ€æ›´æ–° â†’ UIåˆ·æ–° â†’ æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨
3. **éŸ³é¢‘æ’­æ”¾æµ**ï¼šæ ¼å¼æ£€æµ‹ â†’ MP3/WAVè§£ç  â†’ éŸ³é¢‘æ§åˆ¶ â†’ ç¡¬ä»¶æ’­æ”¾ â†’ çŠ¶æ€åé¦ˆ â†’ è¿›åº¦æ›´æ–°  
4. **æ¨¡å—é€šä¿¡æµ**ï¼šä¸»ç•Œé¢ â†” æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ â†” éŸ³é¢‘æ§åˆ¶å™¨ â†” çŠ¶æ€ç®¡ç†

è¿™ç§æ¨¡å—åŒ–è®¾è®¡ç¡®ä¿äº†ç”¨æˆ·ç•Œé¢å“åº”æ€§ã€éŸ³é¢‘æ’­æ”¾çš„ç¨³å®šæ€§å’Œä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚

### æ¨¡å—å…³ç³»

![æ¨¡å—å…³ç³»](docs_png/æ¨¡å—å…³ç³».png)

æ–°æ¶æ„ä¸‹çš„æ¨¡å—é—´ä¾èµ–å…³ç³»æ›´åŠ æ¸…æ™°æ˜ç¡®ï¼š

- **main** å‡½æ•°é¦–å…ˆè°ƒç”¨ **splash_screen_create()** åˆ›å»ºå¯åŠ¨é¡µé¢
- **splash_screen** æ¨¡å—åœ¨åŠ¨ç”»å®Œæˆåè‡ªåŠ¨è°ƒç”¨ **app_create()** 
- **init_resource** è´Ÿè´£åŠ è½½LVGLå­—ä½“ã€å›¾ç‰‡å’ŒéŸ³ä¹é…ç½®JSON
- **app_create_main_page** åˆ›å»ºè½¦è½½é£æ ¼UIç»„ä»¶å¹¶è®¾ç½®äº‹ä»¶å¤„ç†
- **playlist_manager** æ¨¡å—ç‹¬ç«‹ç®¡ç†æ’­æ”¾åˆ—è¡¨UIå’Œäº¤äº’é€»è¾‘
- **audio_ctl** æ¨¡å—æ”¯æŒMP3/WAVæ ¼å¼ï¼Œé€šè¿‡ **nxaudio** ä¸åº•å±‚éŸ³é¢‘ç³»ç»Ÿäº¤äº’
- **ui_events** è§¦å‘ **state_machine** çŠ¶æ€è½¬æ¢ï¼ŒåŒæ—¶æ›´æ–°ä¸»ç•Œé¢å’Œæ’­æ”¾åˆ—è¡¨æ˜¾ç¤º
- å„æ¨¡å—é€šè¿‡æ˜ç¡®çš„APIæ¥å£è¿›è¡Œé€šä¿¡ï¼Œæ”¯æŒæ¨¡å—é—´è§£è€¦

### å…³é”®æ•°æ®ç»“æ„

#### è¿è¡Œæ—¶ä¸Šä¸‹æ–‡
```c
struct ctx_s {
    bool resource_healthy_check;          // èµ„æºå¥åº·æ£€æŸ¥
    album_info_t* current_album;          // å½“å‰ä¸“è¾‘
    lv_obj_t* current_album_related_obj;  // å…³è”UIå¯¹è±¡
    
    uint16_t volume;                      // éŸ³é‡
    play_status_t play_status_prev;       // ä¸Šä¸€æ¬¡æ’­æ”¾çŠ¶æ€
    play_status_t play_status;            // å½“å‰æ’­æ”¾çŠ¶æ€
    uint64_t current_time;                // å½“å‰æ’­æ”¾æ—¶é—´
    
    struct {
        lv_timer_t* volume_bar_countdown;      // éŸ³é‡æ¡å€’è®¡æ—¶
        lv_timer_t* playback_progress_update;  // æ’­æ”¾è¿›åº¦æ›´æ–°
        lv_timer_t* refresh_date_time;         // æ—¶é—´æ—¥æœŸåˆ·æ–°ï¼ˆæ–°å¢ï¼‰
    } timers;
    
    audioctl_s* audioctl;                 // éŸ³é¢‘æ§åˆ¶å¥æŸ„
};
```

#### èµ„æºç®¡ç†
```c
struct resource_s {
    struct {
        lv_obj_t* time;                    // æ—¶é—´æ˜¾ç¤º
        lv_obj_t* date;                    // æ—¥æœŸæ˜¾ç¤º  
        lv_obj_t* player_group;            // æ’­æ”¾å™¨ç»„
        lv_obj_t* album_cover_container;   // åœ†å½¢å°é¢å®¹å™¨ï¼ˆæ–°å¢ï¼‰
        lv_obj_t* volume_bar;              // éŸ³é‡æ¡
        lv_obj_t* volume_bar_indic;        // éŸ³é‡æŒ‡ç¤ºå™¨
        lv_obj_t* playlist;                // æ’­æ”¾åˆ—è¡¨ï¼ˆåŸåŸºç¡€åˆ—è¡¨ï¼‰
        lv_obj_t* frosted_bg;              // ç£¨ç ‚ç»ç’ƒèƒŒæ™¯ï¼ˆæ–°å¢ï¼‰
        // ... æ›´å¤šUIç»„ä»¶
    } ui;
    
    struct {
        struct { const lv_font_t* normal; } size_16;  // å·²æ›´æ–°ä¸ºconst
        struct { const lv_font_t* bold; } size_22;
        struct { const lv_font_t* normal; } size_24;
        struct { const lv_font_t* normal; } size_28;
        struct { const lv_font_t* bold; } size_60;    // è½¦è½½å¤§æ ‡é¢˜å­—ä½“
    } fonts;
    
    struct {
        lv_style_t button_default;         // æŒ‰é’®é»˜è®¤æ ·å¼
        lv_style_t button_pressed;         // æŒ‰é’®æŒ‰ä¸‹æ ·å¼
        lv_style_t circular_cover;          // åœ†å½¢å°é¢æ ·å¼ï¼ˆæ–°å¢ï¼‰
        lv_style_t frosted_glass;           // ç£¨ç ‚ç»ç’ƒæ ·å¼ï¼ˆæ–°å¢ï¼‰
        lv_style_t modern_card;             // ç°ä»£å¡ç‰‡æ ·å¼ï¼ˆæ–°å¢ï¼‰
    } styles;
    
    album_info_t* albums;                  // ä¸“è¾‘æ•°ç»„
    uint8_t album_count;                   // ä¸“è¾‘æ•°é‡
};
```

### çŠ¶æ€æœºè®¾è®¡

```c
typedef enum {
    PLAY_STATUS_STOP,    // åœæ­¢
    PLAY_STATUS_PLAY,    // æ’­æ”¾
    PLAY_STATUS_PAUSE,   // æš‚åœ
} play_status_t;

// çŠ¶æ€è½¬æ¢è¡¨
static const state_transition_t transitions[] = {
    {PLAY_STATUS_STOP,  PLAY_STATUS_PLAY,  action_start_playback},
    {PLAY_STATUS_PLAY,  PLAY_STATUS_PAUSE, action_pause_playback},
    {PLAY_STATUS_PAUSE, PLAY_STATUS_PLAY,  action_resume_playback},
    {PLAY_STATUS_PLAY,  PLAY_STATUS_STOP,  action_stop_playback},
    {PLAY_STATUS_PAUSE, PLAY_STATUS_STOP,  action_stop_playback},
};
```

## ğŸ“š API å‚è€ƒ

### æ ¸å¿ƒ API

#### åº”ç”¨ç¨‹åºæ§åˆ¶
```c
/**
 * @brief åˆ›å»ºå¹¶åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨åº”ç”¨
 * @return void
 */
void app_create(void);

/**
 * @brief è®¾ç½®æ’­æ”¾çŠ¶æ€
 * @param status æ’­æ”¾çŠ¶æ€
 */
static void app_set_play_status(play_status_t status);

/**
 * @brief åˆ‡æ¢åˆ°æŒ‡å®šä¸“è¾‘ï¼ˆç°å·²å…¬å¼€ï¼Œä¾›æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨è°ƒç”¨ï¼‰
 * @param index ä¸“è¾‘ç´¢å¼•
 */
void app_switch_to_album(int index);

/**
 * @brief è®¾ç½®éŸ³é‡
 * @param volume éŸ³é‡å€¼ (0-100)
 */
static void app_set_volume(uint16_t volume);

/**
 * @brief åˆ·æ–°æ—¶é—´æ—¥æœŸæ˜¾ç¤º
 */
static void app_refresh_date_time(void);

/**
 * @brief å¯åŠ¨æ—¶é—´æ—¥æœŸæ›´æ–°å®šæ—¶å™¨
 */
static void app_start_updating_date_time(void);
```

#### å¯åŠ¨é¡µé¢æ¨¡å— API
```c
/**
 * @brief åˆ›å»ºå¯åŠ¨é¡µé¢
 * @note è‡ªåŠ¨æ˜¾ç¤ºLogoåŠ¨ç”»ï¼Œ2ç§’åè·³è½¬ä¸»ç•Œé¢
 */
void splash_screen_create(void);
```

#### æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨ API
```c
/**
 * @brief åˆ›å»ºä¸“ä¸šæ’­æ”¾åˆ—è¡¨ç•Œé¢
 * @param parent çˆ¶å®¹å™¨
 */
void playlist_manager_create(lv_obj_t* parent);

/**
 * @brief åˆ·æ–°æ’­æ”¾åˆ—è¡¨æ˜¾ç¤º
 */
void playlist_manager_refresh(void);

/**
 * @brief å…³é—­æ’­æ”¾åˆ—è¡¨
 */
void playlist_manager_close(void);

/**
 * @brief æ£€æŸ¥æ’­æ”¾åˆ—è¡¨æ˜¯å¦æ‰“å¼€
 * @return true if open, false if closed
 */
bool playlist_manager_is_open(void);
```

#### éŸ³é¢‘æ§åˆ¶ APIï¼ˆå·²å¢å¼ºï¼‰
```c
/**
 * @brief åˆå§‹åŒ–éŸ³é¢‘æ§åˆ¶å™¨ï¼ˆæ”¯æŒå¤šæ ¼å¼ï¼‰
 * @param file_path éŸ³é¢‘æ–‡ä»¶è·¯å¾„ï¼ˆæ”¯æŒMP3/WAVï¼‰
 * @return éŸ³é¢‘æ§åˆ¶å¥æŸ„
 */
audioctl_s* audio_ctl_init_nxaudio(const char* file_path);

/**
 * @brief æ£€æµ‹éŸ³é¢‘æ–‡ä»¶æ ¼å¼
 * @param filename æ–‡ä»¶å
 * @return éŸ³é¢‘æ ¼å¼ç±»å‹ï¼ˆFORMAT_MP3/FORMAT_WAVï¼‰
 */
int audio_ctl_detect_format(const char* filename);

/**
 * @brief å¼€å§‹æ’­æ”¾
 * @param audioctl éŸ³é¢‘æ§åˆ¶å¥æŸ„
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int audio_ctl_start(audioctl_s* audioctl);

/**
 * @brief æš‚åœæ’­æ”¾
 * @param audioctl éŸ³é¢‘æ§åˆ¶å¥æŸ„
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int audio_ctl_pause(audioctl_s* audioctl);

/**
 * @brief åœæ­¢æ’­æ”¾
 * @param audioctl éŸ³é¢‘æ§åˆ¶å¥æŸ„
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int audio_ctl_stop(audioctl_s* audioctl);

/**
 * @brief è®¾ç½®éŸ³é‡
 * @param audioctl éŸ³é¢‘æ§åˆ¶å¥æŸ„
 * @param volume éŸ³é‡å€¼
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int audio_ctl_set_volume(audioctl_s* audioctl, uint16_t volume);

#ifdef CONFIG_LVX_MUSIC_PLAYER_MP3_SUPPORT
/**
 * @brief åˆå§‹åŒ–MP3è§£ç å™¨
 * @param decoder MP3è§£ç å™¨ç»“æ„
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int mp3_decoder_init(mp3_decoder_s* decoder);

/**
 * @brief è§£ç MP3æ•°æ®
 * @param decoder MP3è§£ç å™¨
 * @param input_data è¾“å…¥MP3æ•°æ®
 * @param input_size è¾“å…¥æ•°æ®å¤§å°
 * @param output_pcm è¾“å‡ºPCMæ•°æ®
 * @param output_size è¾“å‡ºæ•°æ®å¤§å°
 * @return è§£ç çš„å­—èŠ‚æ•°ï¼Œ-1è¡¨ç¤ºå¤±è´¥
 */
int mp3_decoder_decode(mp3_decoder_s* decoder, const uint8_t* input_data, 
                       size_t input_size, int16_t* output_pcm, size_t* output_size);
#endif
```

#### Wi-Fi ç®¡ç† API
```c
/**
 * @brief Wi-Fi é…ç½®ç»“æ„
 */
typedef struct {
    char ssid[64];      // ç½‘ç»œåç§°
    char psk[128];      // å¯†ç 
    uint32_t conn_delay; // è¿æ¥å»¶è¿Ÿ
} wifi_conf_t;

/**
 * @brief è¿æ¥ Wi-Fi
 * @param conf Wi-Fi é…ç½®
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int wifi_connect(wifi_conf_t* conf);

/**
 * @brief æ–­å¼€ Wi-Fi è¿æ¥
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int wifi_disconnect(void);

/**
 * @brief è·å–è¿æ¥çŠ¶æ€
 * @return true å·²è¿æ¥, false æœªè¿æ¥
 */
bool wifi_is_connected(void);
```

### UI ç»„ä»¶ API

#### äº‹ä»¶å¤„ç†
```c
/**
 * @brief æ’­æ”¾æŒ‰é’®äº‹ä»¶å¤„ç†
 * @param e äº‹ä»¶å¯¹è±¡
 */
static void app_play_status_event_handler(lv_event_t* e);

/**
 * @brief éŸ³é‡æ¡äº‹ä»¶å¤„ç†
 * @param e äº‹ä»¶å¯¹è±¡
 */
static void app_volume_bar_event_handler(lv_event_t* e);

/**
 * @brief æ’­æ”¾åˆ—è¡¨äº‹ä»¶å¤„ç†
 * @param e äº‹ä»¶å¯¹è±¡
 */
static void app_playlist_event_handler(lv_event_t* e);
```

#### UI åˆ·æ–°
```c
/**
 * @brief åˆ·æ–°ä¸“è¾‘ä¿¡æ¯æ˜¾ç¤º
 */
static void app_refresh_album_info(void);

/**
 * @brief åˆ·æ–°æ’­æ”¾è¿›åº¦
 */
static void app_refresh_playback_progress(void);

/**
 * @brief åˆ·æ–°éŸ³é‡æ¡
 */
static void app_refresh_volume_bar(void);

/**
 * @brief åˆ·æ–°æ’­æ”¾åˆ—è¡¨
 */
static void app_refresh_playlist(void);
```

### é…ç½® API

#### é…ç½®æ–‡ä»¶ç®¡ç†
```c
/**
 * @brief è¯»å–é…ç½®æ–‡ä»¶
 */
static void read_configs(void);

/**
 * @brief é‡æ–°åŠ è½½éŸ³ä¹é…ç½®
 */
static void reload_music_config(void);

/**
 * @brief ä¿å­˜é…ç½®
 * @param config é…ç½®ç»“æ„
 * @return 0 æˆåŠŸ, -1 å¤±è´¥
 */
int save_config(const config_t* config);
```

#### èµ„æºç®¡ç†
```c
/**
 * @brief åˆå§‹åŒ–èµ„æº
 * @return true æˆåŠŸ, false å¤±è´¥
 */
static bool init_resource(void);

/**
 * @brief åŠ è½½å­—ä½“èµ„æº
 * @return true æˆåŠŸ, false å¤±è´¥
 */
static bool load_fonts(void);

/**
 * @brief åŠ è½½å›¾ç‰‡èµ„æº
 * @return true æˆåŠŸ, false å¤±è´¥
 */
static bool load_images(void);

/**
 * @brief é‡Šæ”¾èµ„æº
 */
static void cleanup_resources(void);
```

### é”™è¯¯ä»£ç 

```c
#define MUSIC_ERROR_OK              0    // æˆåŠŸ
#define MUSIC_ERROR_INVALID_PARAM  -1    // æ— æ•ˆå‚æ•°
#define MUSIC_ERROR_NO_MEMORY      -2    // å†…å­˜ä¸è¶³
#define MUSIC_ERROR_FILE_NOT_FOUND -3    // æ–‡ä»¶æœªæ‰¾åˆ°
#define MUSIC_ERROR_AUDIO_INIT     -4    // éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥
#define MUSIC_ERROR_NETWORK        -5    // ç½‘ç»œé”™è¯¯
#define MUSIC_ERROR_CONFIG         -6    // é…ç½®é”™è¯¯
```

## è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. **Fork é¡¹ç›®**
   ```bash
   git clone https://github.com/your-username/openvela-music-player.git
   cd openvela-music-player
   ```

2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feature/new-feature
   ```

3. **å¼€å‘å’Œæµ‹è¯•**
   ```bash
   # å¼€å‘æ–°åŠŸèƒ½
   # ç¼–å†™æµ‹è¯•ç”¨ä¾‹
   # è¿è¡Œæµ‹è¯•
   make test
   ```

4. **æäº¤æ›´æ”¹**
   ```bash
   git add .
   git commit -m "feat: add new audio format support"
   ```

5. **æ¨é€å’ŒPR**
   ```bash
   git push origin feature/new-feature
   # åˆ›å»º Pull Request
   ```

### ä»£ç è§„èŒƒ

#### C ä»£ç é£æ ¼
```c
// å‡½æ•°å‘½åï¼šsnake_case
static void app_create_main_page(void);

// å˜é‡å‘½åï¼šsnake_case
static bool resource_healthy_check = false;

// å¸¸é‡å‘½åï¼šUPPER_CASE
#define MAX_ALBUM_COUNT 100

// ç»“æ„ä½“å‘½åï¼šsnake_case_t
typedef struct album_info_s {
    const char* name;
    const char* artist;
} album_info_t;
```

#### æ³¨é‡Šè§„èŒƒ
```c
/**
 * @brief å‡½æ•°ç®€è¦æè¿°
 * @param param1 å‚æ•°1æè¿°
 * @param param2 å‚æ•°2æè¿°
 * @return è¿”å›å€¼æè¿°
 * @note æ³¨æ„äº‹é¡¹
 * @warning è­¦å‘Šä¿¡æ¯
 */
int function_name(int param1, const char* param2);
```

#### æäº¤ä¿¡æ¯è§„èŒƒ
```
feat: æ–°åŠŸèƒ½
fix: ä¿®å¤bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·ç›¸å…³

ç¤ºä¾‹ï¼š
feat: add MP3 audio format support
fix: resolve memory leak in audio playback
docs: update API documentation
```

### æµ‹è¯•æŒ‡å—

#### å•å…ƒæµ‹è¯•
```c
// test/test_audio_ctl.c
#include "unity.h"
#include "audio_ctl.h"

void test_audio_ctl_init(void) {
    audioctl_s* ctl = audio_ctl_init_nxaudio("test.wav");
    TEST_ASSERT_NOT_NULL(ctl);
    audio_ctl_uninit_nxaudio(ctl);
}

void test_audio_ctl_volume(void) {
    audioctl_s* ctl = audio_ctl_init_nxaudio("test.wav");
    int result = audio_ctl_set_volume(ctl, 50);
    TEST_ASSERT_EQUAL(0, result);
    audio_ctl_uninit_nxaudio(ctl);
}
```

#### é›†æˆæµ‹è¯•
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./scripts/run_tests.sh

# è¿è¡Œæ€§èƒ½æµ‹è¯•
./scripts/performance_test.sh

# è¿è¡Œå†…å­˜æ³„æ¼æµ‹è¯•
valgrind --leak-check=full ./music_player
```

### æ–‡æ¡£è´¡çŒ®

1. **API æ–‡æ¡£**ï¼šä½¿ç”¨ Doxygen æ ¼å¼
2. **ç”¨æˆ·æ–‡æ¡£**ï¼šä½¿ç”¨ Markdown æ ¼å¼
3. **ä»£ç ç¤ºä¾‹**ï¼šæä¾›å®Œæ•´å¯è¿è¡Œçš„ç¤ºä¾‹
4. **ç¿»è¯‘**ï¼šæ”¯æŒå¤šè¯­è¨€æ–‡æ¡£

### é—®é¢˜æŠ¥å‘Š

æäº¤ Issue æ—¶è¯·åŒ…å«ï¼š
- æ“ä½œç³»ç»Ÿå’Œç‰ˆæœ¬
- OpenVela ç‰ˆæœ¬
- å¤ç°æ­¥éª¤
- æœŸæœ›è¡Œä¸º
- å®é™…è¡Œä¸º
- ç›¸å…³æ—¥å¿—

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache License 2.0 å¼€æºè®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- **OpenVela å›¢é˜Ÿ**ï¼šæä¾›ä¼˜ç§€çš„åµŒå…¥å¼æ“ä½œç³»ç»Ÿå¹³å°
- **LVGL ç¤¾åŒº**ï¼šæä¾›å¼ºå¤§çš„å›¾å½¢åº“å’Œè½¦è½½UIç»„ä»¶æ”¯æŒ
- **NuttX é¡¹ç›®**ï¼šæä¾›å¯é çš„å®æ—¶æ“ä½œç³»ç»Ÿå†…æ ¸å’ŒéŸ³é¢‘æ¡†æ¶
- **libmad å¼€å‘è€…**ï¼šæä¾›é«˜è´¨é‡çš„MP3è§£ç åº“
- **æ‰€æœ‰è´¡çŒ®è€…**ï¼šæ„Ÿè°¢æ¯ä¸€ä¸ªè´¡çŒ®ä»£ç ã€æ–‡æ¡£å’Œå»ºè®®çš„å¼€å‘è€…
- **Vela å“ç‰Œ**ï¼šæ„Ÿè°¢å“ç‰Œæ”¯æŒå’ŒUIè®¾è®¡æŒ‡å¯¼

## ğŸ“ è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µ**ï¼šhttps://github.com/openvela/music-player
- **æ–‡æ¡£ç«™ç‚¹**ï¼šhttps://docs.openvela.org/music-player  
- **é—®é¢˜åé¦ˆ**ï¼šhttps://github.com/openvela/music-player/issues
- **è®¨è®ºç¤¾åŒº**ï¼šhttps://forum.openvela.org
- **Vela Audio**ï¼švela@music-player.com

## ğŸ†• æ›´æ–°æ—¥å¿—

### v2.0.0 - è½¦è½½ä¸“ä¸šç‰ˆ (2024-12-18)
- âœ… **å…¨æ–°è½¦è½½UIè®¾è®¡**ï¼šç°ä»£åŒ–è½¦è½½é£æ ¼ç•Œé¢
- âœ… **å¯åŠ¨é¡µé¢æ¨¡å—**ï¼šå“ç‰ŒLogoåŠ¨ç”»å’ŒåŠ è½½æ•ˆæœ
- âœ… **æ’­æ”¾åˆ—è¡¨ç®¡ç†å™¨**ï¼šç‹¬ç«‹æ¨¡å—åŒ–æ’­æ”¾åˆ—è¡¨
- âœ… **MP3æ ¼å¼æ”¯æŒ**ï¼šlibmadé«˜è´¨é‡è§£ç 
- âœ… **é¡¶éƒ¨çŠ¶æ€æ **ï¼šæ—¶é—´ã€æ—¥æœŸã€Wi-Fiã€ç”µæ± æ˜¾ç¤º
- âœ… **é«˜çº§æ ·å¼ç³»ç»Ÿ**ï¼šç£¨ç ‚ç»ç’ƒã€æ¸å˜ã€éœ“è™¹ä¸»é¢˜
- âœ… **æ¨¡å—åŒ–æ¶æ„**ï¼šæ›´å¥½çš„ä»£ç ç»„ç»‡å’Œå¯ç»´æŠ¤æ€§

### v1.0.0 - åŸºç¡€ç‰ˆæœ¬ (2024-08-20)
- âœ… åŸºç¡€éŸ³ä¹æ’­æ”¾åŠŸèƒ½
- âœ… WAVæ ¼å¼æ”¯æŒ
- âœ… ç®€å•UIç•Œé¢

---

*æœ€åæ›´æ–°æ—¶é—´ï¼š2024-12-18*
*å½“å‰ç‰ˆæœ¬ï¼šv2.0.0 è½¦è½½ä¸“ä¸šç‰ˆ*
